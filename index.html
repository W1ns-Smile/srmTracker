<!DOCTYPE html>
<html lang="ru">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1"
      crossorigin="anonymous"
    />

    <title>srmTracker</title>
  </head>
  <body style="width: 90%; margin: 0 auto">
    <h1>srmTracker</h1>

    <table id="table-res" class="table table-hover">
      <thead>
        <tr>
          <th scope="col">ID TMDB</th>
          <th scope="col">Название</th>
          <th scope="col">Оригинальное название</th>
          <th scope="col">Английское название</th>
          <th scope="col">Тип</th>
          <th scope="col">Сезон</th>
          <th scope="col">Дата релиза</th>
          <th scope="col">Статус</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th scope="row">71912</th>
          <td>Ведьмак</td>
          <td>The Witcher</td>
          <td>The Witcher</td>
          <td>Сериал</td>
          <td>2 сезон</td>
          <td>2021</td>
          <td>В производстве</td>
        </tr>
        <tr>
          <th scope="row">66732</th>
          <td>Очень странные дела</td>
          <td>Stranger Things</td>
          <td>Stranger Things</td>
          <td>Сериал</td>
          <td>4 сезон</td>
          <td>2021</td>
          <td>В производстве</td>
        </tr>
      </tbody>
    </table>

    <form class="row gy-2 gx-3 align-items-center">
      <div class="col-auto">
        <label class="visually-hidden" for="autoSizingInput">ID TMDB</label>
        <input
          type="text"
          class="form-control"
          id="tmdb-id autoSizingInput"
          placeholder="ID TMDB*"
          required
        />
      </div>
      <div class="col-auto">
        <label class="visually-hidden" for="autoSizingInput"
          >Номер сезона</label
        >
        <input
          type="text"
          class="form-control"
          id="autoSizingInput"
          placeholder="Номер сезона"
        />
      </div>
      <div class="col-auto">
        <label class="visually-hidden" for="autoSizingSelect">Тип</label>
        <select class="form-select" id="tmdb-type autoSizingSelect">
          <option selected>Выбрать тип</option>
          <option value="1">Сериал</option>
          <option value="2">Фильм</option>
        </select>
      </div>
      <div class="col-auto">
        <button
          type="submit"
          class="btn btn-danger"
          onclick="addRow('table-res')"
        >
          Добавить
        </button>
      </div>
    </form>

    <!--     <div class="alert alert-success alert-dismissible fade show" role="alert">
      <strong>Успешно!</strong> Сериал успешно добавлен в таблицу для отслеживания.
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>

    <div class="alert alert-danger alert-dismissible fade show" role="alert">
      <strong>Ошибка!</strong> Сериал не был добавлен, проверьте правильность в названии или типе сериала.
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div> -->

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"
      crossorigin="anonymous"
    ></script>
    <script>
      function addRow(id) {
        var tmdbID = document.getElementById("tmdb-id").value;
        (async () => {
      let url = "https://api.themoviedb.org/3/tv/" + tmdbID + "?api_key=50dc44cf889efcd7cce1f8cb9fcf6ad5&language=ru-RU";
      let response = await fetch(url);
      let commits = await response.json();

      var rusName = commits.name;
      var usName = commits.original_name;
      var orName = commits.original_name;
      var type = document.getElementById("tmdb-type").value;
      var season = commits.seasons.name;
      if (type == 'Сериал') {
        var relDate = commits.first_air_date;
      }
      else {
        var relDate = commits.release_date;
      }
      var status = commits.status;
      console.log(rusName);
    })()

        var tbody = document
          .getElementById(id)
          .getElementsByTagName("TBODY")[0];
        var row = document.createElement("TR");
        var th = document.createElement("TH");
        th.setAttribute("scope", "row");
        th.appendChild(document.createTextNode(tmdbID));
        var td1 = document.createElement("TD");
        td1.appendChild(document.createTextNode(rusName));
        var td2 = document.createElement("TD");
        td2.appendChild(document.createTextNode(usName));
        var td3 = document.createElement("TD");
        td3.appendChild(document.createTextNode(orName));
        var td4 = document.createElement("TD");
        td4.appendChild(document.createTextNode(type));
        var td5 = document.createElement("TD");
        td5.appendChild(document.createTextNode(season));
        var td6 = document.createElement("TD");
        td6.appendChild(document.createTextNode(relDate));
        var td7 = document.createElement("TD");
        td7.appendChild(document.createTextNode(status));
        row.appendChild(th);
        row.appendChild(td1);
        row.appendChild(td2);
        row.appendChild(td3);
        row.appendChild(td4);
        row.appendChild(td5);
        row.appendChild(td6);
        row.appendChild(td7);
        tbody.appendChild(row);
      }
    </script>
  </body>
</html>
